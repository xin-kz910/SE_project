<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}å·¥ä½œå§”è¨—å¹³å°{% endblock %}</title>
  <link rel="stylesheet" href="/www/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
<header id="main-header">
  <div class="header-bar">
    <!-- å·¦é‚Šï¼šLogo -->
    <a href="/" class="header-logo">ğŸ§© å·¥ä½œå§”è¨—å¹³å°</a>

    <!-- å³é‚Šï¼šä½¿ç”¨è€…ç‹€æ…‹ -->
    <div class="header-actions">
      {% if request.session.get("user") %}
        {% set u = request.session.get("user") %}
        <span class="user-role">{{ 'å§”è¨—äºº' if u.role=='client' else 'æ¥æ¡ˆäºº' }}</span>
        <span class="user-name">æ‚¨å¥½ï¼Œ{{ u.username }}</span>
        <a href="/logout" class="btn-logout">ç™»å‡º</a>
      {% else %}
        <a href="/login" class="btn-login">ç™»å…¥</a>
        <a href="/register" class="btn-register">è¨»å†Š</a>
      {% endif %}
    </div>
  </div>
</header>


<main class="container">
  {% block content %}{% endblock %}
</main>

<footer class="footer">
  <div class="container">Â© 2025 KL STUDIO ï½œ å§”è¨—å¹³å°</div>
</footer>

<script>
// Query string noticesï¼ˆæ²¿ç”¨åŸè¡Œç‚ºï¼‰
const params = new URLSearchParams(window.location.search);
if (params.get('upload') === 'success') { showNotice("âœ… æª”æ¡ˆå·²ä¸Šå‚³æˆåŠŸï¼Œç­‰å¾…å§”è¨—äººå¯©æ ¸ã€‚", "success"); }
if (params.get('action') === 'closed') { showNotice("âœ… å°ˆæ¡ˆå·²æˆåŠŸçµæ¡ˆã€‚", "success"); }
if (params.get('action') === 'reopened') { showNotice("â— å°ˆæ¡ˆå·²é€€ä»¶ï¼Œç­‰å¾…æ¥æ¡ˆäººé‡æ–°ä¸Šå‚³ã€‚", "warn"); }
function showNotice(msg, type){ const box=document.createElement('div'); box.className='notice '+type; box.innerText=msg; document.body.appendChild(box); setTimeout(()=>box.remove(),4000); }
</script>

{% if request.session.get("user") and request.session.get("user").role == 'client' %}
  <a href="/projects/create" class="fab" title="æ–°å¢å°ˆæ¡ˆ">ï¼‹</a>
{% endif %}

</body>
</html>